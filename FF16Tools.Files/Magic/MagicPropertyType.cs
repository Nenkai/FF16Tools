using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace FF16Tools.Files.Magic;

/// <summary>
/// This is the full list of supported magic properties, including ones that existing game files don't use.
/// </summary>
public enum MagicPropertyType : uint
{
    Prop_1 = 1,

    Prop_2 = 2, // GLOBAL

    Prop_3 = 3,
    Prop_4 = 4,
    Prop_5 = 5,
    Prop_6 = 6,
    Prop_7 = 7,
    ProjectileSpeedStart = 8,
    ProjectileSpeedIncreaseRate = 9,
    ProjectileSpeedStartRangeRand = 10,
    ProjectileSpeedMax = 11,
    ProjectileYOffset = 12, // Bypasses source Eid
    ProjectileNoTrackingTarget = 13,
    ProjectileTrackingRotationRate = 14, // From source to target, per tick?
    Prop_15 = 15,
    ProjectileNormalizeXZTarget = 16,
    ProjectileYRandOffset = 17,
    ProjectileBindPositionToSourceActor = 18,
    ProjectileBindPositionToSourceActorNoProgress = 19,
    ProjectileXSinWaveToTarget = 20,  // Depends on Prop24?
    Prop_21_EidId = 21,
    Prop_22_VerticalAngleDegreesOffset = 22,
    ProjectileDirectionAngles = 23,
    Prop_24 = 24,
    Prop_25 = 25,
    ProjectileCreationOpGroupId = 26,
    MainVFXAudioId = 27,
    Prop_28 = 28,
    Prop_29 = 29,
    Prop_30 = 30,
    VFXScale = 31,
    VFX_XYZOffset = 32,
    Prop_33 = 33,
    Prop_34 = 34,
    ProjectileDuration = 35,
    ProjectileDurationRandomRange = 36,
    ProjectileNoImpactOpGroupIdCallback = 37,
    Prop_38 = 38,
    OnDestroyOpGroupIdCallback = 39,
    ProjectileOnHitAttackParamId = 41,
    DistanceStart = 42,
    DistanceIncreaseRate = 43,
    DistanceMax = 44,

    // todo verify:
    // 0 = Sphere, Prop 42
    // 1 = Arc, Prop 42, 46
    // 2 = Capsule, Prop 42, 47
    // 3 = CapsuleClamped, Prop 42, 47, 48
    // 4 = ?
    // 5 = SphereChain, Prop 42, 47
    // 6 = CapsuleCentered, Prop 42, 47
    // 7 = CapsuleClampedCentered, Prop 42, 47, 48
    // 8 = AnchoredCapsule, Prop 42, 46
    // 9 =  Box, Prop 42, 46, 47
    // 10 = Box Centered, Prop 42, 46, 47
    // 11 = AnchoredCapsuleCentered, Prop 42, 46
    CollisionShapeType = 45, // 0 through 11

    Prop_46 = 46,
    HeightUnk = 47,
    UnkMax = 48,
    DelaySecond = 49,

    Projectile1XYZOffset = 52, // Tied to NumProjectilesToSpawn
    Projectile2XYZOffset = 53, // Also used in SourceVFX
    Projectile3XYZOffset = 54,
    Projectile4XYZOffset = 55, // OpInitialize
    Projectile5XYZOffset = 56,
    Projectile6XYZOffset = 57,
    Projectile7XYZOffset = 58,
    Projectile8XYZOffset = 59,
    Projectile9XYZOffset = 60,
    Projectile10XYZOffset = 61,
    Projectile11XYZOffset = 62,
    Projectile12XYZOffset = 63,

    MultiProjectileRandBoxExtend = 64,
    MultiProjectileRandUniform = 65,
    MultiProjectileMinRandRadius = 66,
    NumProjectilesToSpawnRandom = 67, // OpInitialize
    OnProjectilePlacedMagicId = 68, // Requires Prop26 maybe
    Prop_69_TargetType = 69,
    Prop_70_UnkJitterMaxAngleRadXYZ = 70, // maximum angular offset for random rotation, applied around all axis
    Prop_71 = 71,
    ProjectileXYZOffset = 72, // Same as ProjectileYOffset, but XYZ
    Prop_73_Type = 73,
    DelaySecBetweenProjectileCreation = 74,
    NumProjectilesToSpawn = 75,
    Prop_76 = 76,
    Prop_77 = 77, // OpInitialize
    Prop_78 = 78, // OpInitialize
    Prop_79_UnkAngleRadX = 79,
    Prop_80_UnkAngleRadY = 80,
    ActorEidForProjectileSource = 81,
    Prop_82 = 82, // OpInitialize
    Prop_84 = 84,
    Prop_85 = 85,
    ActorVFXAudioId = 89,
    Prop_90_UseProp91 = 90,
    Prop_91 = 91,
    Prop_93 = 93,
    OnTargetHitOpGroupIdCallback = 95,
    Prop_96_OpGroupId = 96,
    Prop_97_OpGroupId = 97,
    Prop_98_OpGroupId = 98,
    Prop_99_OpGroupId = 99,
    OnFinishedOpGroupId = 102,
    Prop_104 = 104,
    Prop_105 = 105,
    Prop_106 = 106,
    Prop_107 = 107,
    Prop_109 = 109,
    Prop_110_OpGroupId = 110,
    Prop_112 = 112, // Op111
    Prop_113 = 113, // Op111
    Prop_114 = 114, // Op111
    ProjectileMaxDistance = 117, 
    Prop_118 = 118, 
    Prop_119 = 119,
    Prop_120 = 120,
    Prop_122 = 122,
    Prop_123 = 123,
    Prop_124 = 124,
    Prop_125 = 125,
    Prop_126 = 126,
    Prop_127 = 127,
    Prop_129 = 129,
    Prop_130 = 130,
    Prop_131 = 131,
    Prop_132 = 132,
    Prop_134 = 134,
    Prop_136 = 136,
    Prop_140 = 140,
    Prop_142 = 142,
    Prop_143 = 143,
    Prop_145 = 145,
    Prop_147 = 147,
    Prop_148 = 148,
    Prop_149 = 149,
    Prop_150 = 150,
    Prop_152 = 152,
    Prop_158 = 158,
    Prop_159 = 159,
    Prop_172 = 172,
    Prop_173 = 173,
    Prop_174 = 174,
    Prop_175 = 175,
    Prop_176 = 176,
    Prop_177 = 177,
    Prop_178 = 178,
    Prop_179 = 179,
    Prop_180 = 180,
    Prop_181 = 181,
    Prop_185_UnkAngleRadZ = 185, // Same as 79, 80, but Z
    Prop_186 = 186,
    Prop_187 = 187,
    Prop_188 = 188,
    Prop_190 = 190,
    Prop_191 = 191,
    Prop_192 = 192,
    Prop_193 = 193,

    // Op990
    Prop_994 = 994,
    Prop_995 = 995,

    Prop_997 = 997,
    Prop_1025 = 1025,
    Prop_1026 = 1026,
    Prop_1063 = 1063,
    Prop_1102 = 1102, // OpInitialize
    Prop_1123 = 1123,
    Prop_1231_VFXAudioIdElem1 = 1231, // OpSetupProjectileVFX
    Prop_1232_VFXAudioIdElem2 = 1232, // OpSetupProjectileVFX
    Prop_1269_LayoutInstanceId = 1269, // OpLinearProjectile
    Prop_1286 = 1286,
    Prop_1341 = 1341,
    ProjectileDurationWithDifficultyScale = 1417,
    Prop_1432_OpGroupId = 1432,
    Prop_1433 = 1433,
    Prop_1434 = 1434, // OpInitialize
    Prop_1458 = 1458, // Sets Prop73 to 6 (OpInitialize)
    Prop_1484_UnkJitterMaxAngleRadY = 1484, // Same as 70, but Y only
    Prop_1490 = 1490,
    OnDestroyOpGroupIdCallback2 = 1503, // OpOnFinishSetup - Op39 must be set
    Prop_1649 = 1649,
    MultiProjectileMaxRandRadius = 1657, // OpInitialize
    Prop_1686 = 1686,
    Prop_1687 = 1687,
    Prop_1688 = 1688,
    Prop_1689 = 1689,
    Prop_1690 = 1690,
    Prop_1697 = 1697,
    Prop_1698 = 1698,
    Prop_1704 = 1704,
    Prop_1791 = 1791,
    Prop_1793 = 1793,
    Prop_1794 = 1794,
    Prop_1796 = 1796,
    Prop_1807 = 1807,
    Prop_1818 = 1818,
    Prop_1833_OpGroupId = 1833,
    Prop_1835_OpGroupId = 1835,
    Prop_1957 = 1957,
    Prop_1959 = 1959,
    Prop_1994 = 1994,
    Prop_1997 = 1997,
    Prop_1999 = 1999,
    Prop_2000 = 2000,
    Prop_2028 = 2028,
    Prop_2060 = 2060,
    Prop_2061 = 2061,
    Prop_2062 = 2062,
    Prop_2063 = 2063,
    Prop_2064 = 2064,
    Prop_2065 = 2065,
    Prop_2066 = 2066,
    Prop_2067 = 2067,
    Prop_2068 = 2068,
    Prop_2069 = 2069,
    Prop_2153 = 2153,
    ProjectileStopAtDist = 2211, // OpLinearProjectile
    Prop_2227 = 2227,
    Prop_2259 = 2259,
    Prop_2260 = 2260,
    Prop_2296 = 2296, // OpLinearProjectile
    Prop_2311 = 2311,
    Prop_2318 = 2318,
    Prop_2319 = 2319,
    Prop_2351 = 2351, // OpLinearProjectile
    Prop_2359 = 2359,
    Prop_2367 = 2367,
    Prop_2368 = 2368, // OpLinearProjectile
    Prop_2396_LayoutInstanceId = 2396, // OpInitialize
    Prop_2397_LayoutInstanceDistanceUnk = 2397, // OpInitialize
    Prop_2413_UnkRateForProp47 = 2413,
    Prop_2414_UnkMaxForProp47 = 2414,
    Prop_2420 = 2420,
    Prop_2430 = 2430,
    Prop_2528 = 2528,
    Prop_2529 = 2529,
    Prop_2575_AttackParamId = 2575,
    Prop_2593 = 2593,
    Prop_2599 = 2599,
    Prop_2604 = 2604,
    Prop_2630 = 2630,
    Prop_2672 = 2672,
    Prop_2764 = 2764,
    VFXUnk1_Elem1 = 2798,
    VFXUnk1_Elem2 = 2799,
    Prop_2856 = 2856,
    Prop_2857 = 2857,
    Prop_2858 = 2858,
    Prop_2859 = 2859,
    Prop_2860 = 2860,
    Prop_2906 = 2906,
    Prop_2919 = 2919,
    Prop_2920 = 2920,
    Prop_2921 = 2921,
    Prop_2977 = 2977,
    Prop_2978 = 2978,
    Prop_2979 = 2979,
    Prop_3077 = 3077,
    Prop_3078 = 3078,
    Prop_3079 = 3079,
    Prop_3113 = 3113,
    Prop_3114 = 3114,
    Prop_3115 = 3115,
    Prop_3116 = 3116,
    Prop_3145 = 3145, // Op2493
    Prop_3170 = 3170,
    Prop_3171 = 3171,
    Prop_3172 = 3172,
    Prop_3176 = 3176,
    Prop_3349 = 3349,
    Prop_3362 = 3362,
    Prop_3363 = 3363,
    Prop_3431 = 3431,
    Prop_3432 = 3432,
    Prop_3434 = 3434,
    Prop_3440 = 3440,
    Prop_3441 = 3441,
    Prop_3495 = 3495,
    Prop_3497 = 3497,
    Prop_3498 = 3498,
    Prop_3499 = 3499,
    Prop_3513 = 3513, // OpLinearProjectile
    Prop_3514 = 3514, // OpLinearProjectile - Maybe requires Prop20 (linear proj op?)
    Prop_3544_EidId = 3544,
    Prop_3605 = 3605, // OpLinearProjectile
    Prop_3606 = 3606,
    Prop_3608 = 3608,
    Prop_3609 = 3609,
    Prop_3658 = 3658,
    Prop_3659 = 3659,
    Prop_3681 = 3681,
    Prop_3691 = 3691,
    Prop_3692 = 3692,
    Prop_3693 = 3693,
    Prop_3694 = 3694,
    Prop_3695 = 3695,
    Prop_3696 = 3696,
    Prop_3721 = 3721,
    Prop_3722_EidId = 3722, // OpLinearProjectile
    Prop_3746 = 3746,
    Prop_3747 = 3747,
    Prop_3764 = 3764,
    Prop_3772 = 3772,
    Prop_3782 = 3782,
    Prop_3785 = 3785,
    Prop_3791 = 3791,
    Prop_3802 = 3802,
    Prop_3848 = 3848,
    Prop_3856 = 3856,
    Prop_3872 = 3872,

    // Op3877
    Prop_3897 = 3897,
    Prop_3898 = 3898,
    Prop_3899 = 3899,
    Prop_3900 = 3900,
    Prop_3901 = 3901,

    Prop_3903 = 3903,
    Prop_3906 = 3906,
    Prop_3907 = 3907,
    Prop_3911 = 3911,
    Prop_3912 = 3912,
    Prop_3916_Prop71Alt = 3916, // OpInitialize
    Prop_3938_LayoutInstanceId = 3938, // OpInitialize
    Prop_3939 = 3939, // Sets prop 4143 to 2 (OpInitialize)
    Prop_3961 = 3961,
    Prop_3962 = 3962,
    Prop_3963 = 3963,
    Prop_3970 = 3970,
    Prop_4002 = 4002,
    Prop_4003 = 4003,
    Prop_4008 = 4008,
    Prop_4010_UnkJitterMaxAngleRadX = 4010, // Same as 70, but X
    Prop_4011 = 4011,
    Prop_4014 = 4014,
    Prop_4060 = 4060,
    Prop_4071 = 4071,
    ProjectileOnExecuteActionId = 4094, // OpLinearProjectile
    Prop_4101_UnkJitterMaxAngleRadZ = 4101, // Same as 70, but Z
    Prop_4102 = 4102,
    Prop_4103 = 4103, // OpInitialize
    PullDistanceOnTargetted = 4107,
    Prop_4128_UnkTargetType = 4128,
    Prop_4131_AttackParamId = 4131,
    Prop_4132_AttackParamId = 4132,
    Prop_4135 = 4135,
    ProjectileRandXYZOffset = 4136, // OpInitialize - i.e 0.0, 4.0, 0.0 means it'll cast at X, [Y...Y+4.0], Z
    Prop_4142 = 4142, // OpInitialize
    Prop_4143_UnkProjCount = 4143, // OpInitialize - Must not be zero!
    Prop_4144 = 4144, // OpInitialize
    Prop_4165 = 4165,
    VFXUnk2_Elem1 = 4243,
    VFXUnk2_Elem2 = 4244,

    // Op135
    Prop_4258 = 4258,
    Prop_4259 = 4259,
    Prop_4260 = 4260,
    Prop_4261 = 4261,

    // Op4106
    Prop_4262 = 4262,
    Prop_4263 = 4263,

    Prop_4275 = 4275,
    Prop_4276 = 4276,
    Prop_4277 = 4277,
    Prop_4278 = 4278,
    Prop_4279 = 4279,
    Prop_4282 = 4282,
    Prop_4291 = 4291,
    Prop_4293 = 4293,
    Prop_4294 = 4294,
    Prop_4295 = 4295,
    Prop_4297 = 4297,
    Prop_4298 = 4298,
    Prop_4296 = 4296,
    Prop_4327_OpGroupId = 4327,
    Prop_4343_OpGroupId = 4343,
    Prop_4383 = 4383,
    Prop_4387 = 4387,
    Prop_4402_OpGroupId = 4402,
    Prop_4427 = 4427,
    Prop_4436 = 4436,
    Prop_4442 = 4442,
    Prop_4443 = 4443,
    CameraAdjustParamId = 4447, // Op4446
    Prop_4474 = 4474,
    Prop_4509 = 4509,
    Prop_4540 = 4540,
    Prop_4614 = 4614,
    OnMovedOpGroupIdCallback = 4774,
    Prop_4785 = 4785,
    Prop_4786 = 4786,
    Prop_4829 = 4829,

    // Op4106
    Prop_4832 = 4832,
    Prop_4833 = 4833,

    Prop_4845 = 4845,
    Prop_4846 = 4846,
    Prop_4847 = 4847,
    Prop_4848 = 4848,
    Prop_4999 = 4999,
    Prop_5000 = 5000,
    Prop_5034 = 5034,

    // Op5035
    Prop_5036 = 5036,
    Prop_5037 = 5037,
    Prop_5038 = 5038,
    Prop_5039 = 5039,
    Prop_5040 = 5040,
    Prop_5041 = 5041,

    Prop_5101 = 5101,
    Prop_5119 = 5119, // OpInitialize
    Prop_5120 = 5120,
    Prop_5125 = 5125,
    Prop_5142 = 5142,
    Prop_5143 = 5143,
    Prop_5232 = 5232,
    Prop_5234 = 5234,
    Prop_5235 = 5235,
    Prop_5236 = 5236,
    Prop_5237 = 5237,
    Prop_5274_AttackParamId = 5274,
    Prop_5275_AttackParamId = 5275,
    MinSkillUpgradeLevelForAttack_5274_5275 = 5276,
    Prop_5312 = 5312,
    Prop_5322 = 5322,
    Prop_5323 = 5323,
    Prop_5324 = 5324,
    Prop_5325 = 5325,
    Prop_5326 = 5326,
    Prop_5327 = 5327,
    Prop_5355 = 5355,
    Prop_5356 = 5356,
    Prop_5525 = 5525,
    Prop_5642 = 5642,
    ProjectileTranslation = 5644, // OpLinearProjectile
    Prop_5671_OpGroupId = 5671,
    Prop_5683 = 5683,
    Prop_5684 = 5684,
    Prop_5685 = 5685,
    Prop_5747 = 5747,
    Prop_5799 = 5799,
    Prop_5838 = 5838,
    Prop_5839 = 5839,
    Prop_5841 = 5841,
    Prop_5904 = 5904,
    Prop_5932 = 5932,
    Prop_5945 = 5945, // OpInitialize
    Prop_5947 = 5947,
    Prop_5958 = 5958,
    VFXColorUnk = 5959,
    Prop_5970 = 5970,
    Prop_5971 = 5971,
    Prop_5972 = 5972,
    Prop_5973 = 5973,
    Prop_5974 = 5974,
    Prop_5989 = 5989,
    Prop_6050 = 6050,
    Prop_6053 = 6053,
    Prop_6056 = 6056,
    Prop_6087 = 6087,
    Prop_6088 = 6088,
    Prop_6089 = 6089,
    Prop_6090 = 6090,
    Prop_6107_OpGroupId = 6107,
    Prop_6115 = 6115,
    Prop_6119 = 6119,
    Prop_6120 = 6120,
    Prop_6121 = 6121,
    Prop_6122 = 6122,
    Prop_6135 = 6135,
    Prop_6137_OpGroupId = 6137,
    Prop_6170 = 6170,
    Prop_6180 = 6180,
    Prop_6179 = 6179,
    Prop_6184 = 6184,
    Prop_6203 = 6203,
    Prop_6204 = 6204,
    Prop_6208 = 6208,
    Prop_6257 = 6257,
    Prop_6265 = 6265,
    Prop_6270 = 6270,
    Prop_6271 = 6271,
    Prop_6272 = 6272,
    Prop_6273 = 6273,
    Prop_6274 = 6274,
    Prop_6275 = 6275,
    Prop_6276 = 6276,
    Prop_6277 = 6277,
    Prop_6299 = 6299,
    Prop_6287 = 6287,
    Prop_6339 = 6339,
    Prop_6340 = 6340,
    Prop_6376 = 6376,
    Prop_6383 = 6383, // OpInitialize
    Prop_6454 = 6454,
    Prop_6459 = 6459, // Duration related with ActorData45? See code in MagicOperation6460 - 80 7F ? ? 74 ? C5 FA 10 47 ? C5 FA 5C 88
    Prop_6471 = 6471,
    Prop_6474 = 6474,
    Prop_6475 = 6475,
    Prop_6515 = 6515,
    Prop_6516 = 6516,
    Prop_6596 = 6596, // OpInitialize
    Prop_6600_Req6596_UnkY = 6600, // OpInitialize - Requires Prop_6596 set.
    Prop_6685 = 6685,
    Prop_6723 = 6723,
    Prop_6745 = 6745,
    ProjectileSpeedRateRandRange = 6775, // OpLinearProjectile
    Prop_6776 = 6776, // OpLinearProjectile
    Prop_6781 = 6781,
    Prop_6782 = 6782,
    Prop_6800_UnkIncreaseRateForProp48 = 6800,
    Prop_6800_UnkMaxForProp48 = 6801,
    Prop_6822_AttackParamId = 6822,
    Prop_6825 = 6825, // OpLinearProjectile
    Prop_6826 = 6826, // OpLinearProjectile
    Prop_6831 = 6831,
    Prop_6851 = 6851,
    Prop_6913_Type = 6913, // OpInitialize
    Prop_6925 = 6925,
    Prop_6926 = 6926,
    Prop_6927 = 6927,
    Prop_6928 = 6928,
    Prop_6975 = 6975, // OpInitialize
    Prop_6988 = 6988, // OpLinearProjectile
    Prop_7028 = 7028,
    Prop_7037 = 7037, // OpInitialize
    Prop_7039 = 7039,
    Prop_7040 = 7040,
    Prop_7041 = 7041,
    Prop_7042 = 7042,
    Prop_7046 = 7046,
    Prop_7047 = 7047,
    Prop_7099 = 7099,
    Prop_7102 = 7102,
    Prop_7121 = 7121,
    Prop_7186 = 7186, // OpInitialize
    Prop_7200_Prop66Alt = 7200, // OpInitialize
    Prop_7231 = 7231,
    Prop_7293 = 7293,
    Prop_7300 = 7300,
    Prop_7294 = 7294,
    Prop_7366 = 7366,
    Prop_7379 = 7379,
    Prop_7380 = 7380,
    Prop_7411 = 7411,
    Prop_7412 = 7412,

    // Op788
    Prop_7428 = 7428,
    Prop_7429 = 7429,
    Prop_7430 = 7430,

    Prop_7463 = 7463,

    // Op7481
    Prop_7480 = 7480,
    Prop_7482 = 7482,
    Prop_7483 = 7483,
    Prop_7484 = 7484,
    Prop_7485 = 7485,
    Prop_7486 = 7486,

    // Op92
    Prop_7535 = 7535,
    Prop_7536 = 7536,
    Prop_7537 = 7537,
    Prop_7538 = 7538,
    Prop_7539 = 7539,
    Prop_7540 = 7540,
    Prop_7541 = 7541,
    Prop_7542 = 7542,
    Prop_7543 = 7543,

    // Op7584
    Prop_7585 = 7585,
    Prop_7586 = 7586,
    Prop_7587 = 7587,
    Prop_7588 = 7588,

    Prop_7610 = 7610,
    Prop_7691 = 7691, // Op2493
    Prop_7711 = 7711,
    Prop_7712 = 7712,
    Prop_7733 = 7733,
    Prop_7734 = 7734, // Op2493
    Prop_7735 = 7735, // Op2493

    Prop_7757 = 7757,
    VFXUnk2Alt_Elem1 = 7791, // Op25
    VFXUnk2Alt_Elem2 = 7792, // Op25
    Prop_7799 = 7799, // Op1825
    Prop_7807 = 7807, // Op788
    Prop_7809 = 7809, // Op7809
    Prop_7811 = 7811, // OpInitialize
    Prop_7812 = 7812, // Op7584
    Prop_7813 = 7813, // Op25
}
